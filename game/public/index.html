<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Multiplayer Game</title>
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/phaser3-rex-plugins/dist/rexvirtualjoystickplugin.min.js"></script>
    <script src="./client.js"></script>
  </head>
  <body>
    <!-- 모달 및 오버레이 -->
    <div id="modal-overlay"></div>
    <div id="modal">
      <h2>Enter Room Code and Player Name</h2>
      <input type="text" id="roomCode" placeholder="Enter Room Code" />
      <input type="text" id="nickname" placeholder="Enter Player Name" />

      <!-- Profile Image Select Box -->
      <label for="profileImage">Select Profile Image:</label>
      <select id="profileImage">
        <option value="13">Player 1</option>
        <option value="14">Player 2</option>
        <option value="15">Player 3</option>
        <option value="16">Player 4</option>
      </select>

      <!-- Weapon Select Box -->
      <label for="weapon">Select Weapon:</label>
      <select id="weapon">
        <option value="1">메이플 창</option>
        <option value="5">코스모 완드</option>
        <option value="9">황금 옥수수</option>
      </select>

      <!-- Passive Select Box -->
      <label for="passive">Select Passive:</label>
      <select id="passive">
        <option value="2">잭 오 랜턴</option>
        <option value="6">곰</option>
        <option value="10">다라미</option>
      </select>

      <!-- Skill Select Box -->
      <label for="skill">Select Skill:</label>
      <select id="skill">
        <option value="3">솔 폭탄</option>
        <option value="4">드래곤플라이</option>
        <option value="7">뚜기 점프</option>
        <option value="8">버섯</option>
        <option value="11">갤럭시 문</option>
        <option value="12">허수아비</option>
      </select>

      <!-- 체크박스 추가 -->
      <label for="noData">데이터 불러오기:</label>
      <input type="checkbox" id="noData" />

      <button id="joinRoomButton">Join Room</button>
    </div>

    <script>
      // 참가 버튼을 클릭했을 때 모달을 닫고 게임 시작
      document
        .getElementById("joinRoomButton")
        .addEventListener("click", () => {
          const roomCode = document.getElementById("roomCode").value;
          const nickname = document.getElementById("nickname").value;
          const profileImage = document.getElementById("profileImage").value;
          const weapon = document.getElementById("weapon").value;
          const passive = document.getElementById("passive").value;
          const skill = document.getElementById("skill").value;
          const noDataChecked = document.getElementById("noData").checked;

          let playerData = 0;

          if (!noDataChecked) {
            // 체크박스가 체크되지 않은 경우에만 playerData를 계산
            playerData += 1 << Number(profileImage);
            playerData += 1 << Number(weapon);
            playerData += 1 << Number(passive);
            playerData += 1 << Number(skill);
          }

          console.log(`Room code entered: ${roomCode}`);
          console.log(`Player name entered: ${nickname}`);

          joinRoom(roomCode, nickname, playerData); // 입력받은 값을 전달

          // 모달과 오버레이를 숨기고 게임 화면 표시
          document.getElementById("modal").style.display = "none";
          document.getElementById("modal-overlay").style.display = "none";
        });
    </script>
  </body>
</html>
